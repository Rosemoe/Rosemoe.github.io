<!DOCTYPE html><html lang="en" data-theme="light"><head><meta charset="UTF-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width,initial-scale=1"><title>ä½¿ç”¨Android RenderNodeåŠ é€Ÿç»˜åˆ¶ | Rosemoe's Blog</title><meta name="keywords" content="Android"><meta name="author" content="Rosemoe"><meta name="copyright" content="Rosemoe"><meta name="format-detection" content="telephone=no"><meta name="theme-color" content="#ffffff"><meta name="description" content="å†™åœ¨å‰é¢çš„åºŸè¯ç ”ç©¶RenderNodeçš„èµ·å› â€¦ä½œä¸ºä¸€ä¸ªä»£ç ç¼–è¾‘å™¨çš„å¼€å‘è€…ï¼Œæˆ‘ååˆ†å…³æ³¨æˆ‘å†™çš„Viewçš„ç»˜åˆ¶é€Ÿåº¦ã€‚äºæ˜¯å›½åº†èŠ‚æ”¾å‡ï¼Œå¿ƒè¡€æ¥æ½®æµ‹è¯•è‡ªå·±ç¼–è¾‘å™¨å’ŒEditTextç»˜åˆ¶çš„æ€§èƒ½ã€‚å‘ç°ä¸€æ®µä»£ç ï¼Œåœ¨ä¸¤ä¸ªViewä¸­æ˜¾ç¤ºå‡ºæ¥å‡ ä¹æ²¡ä»€ä¹ˆåŒºåˆ«ï¼Œä½†æ˜¯TextViewçš„ç»˜åˆ¶æ¯”å’±å¿«å¤šäº†ï¼Œè¿™æ˜¯ä¸ºä»€ä¹ˆå‘¢ï¼Ÿæˆ‘å°è¯•ä¸€æ®µä¸€æ®µæ³¨é‡Šè‡ªå·±çš„é™¤äº†æ–‡æœ¬ä»¥å¤–å…ƒç´ çš„ç»˜åˆ¶ä»£ç ã€‚ä»å±è”½ä»£ç åŒºåˆ’çº¿ï¼Œåˆ°å±è”½ç©ºç™½å­—ç¬¦çš„ç»˜åˆ¶ï¼Œæœ€åç”šè‡³æŠŠä»£ç é«˜äº®éƒ½æ¢æˆ">
<meta property="og:type" content="article">
<meta property="og:title" content="ä½¿ç”¨Android RenderNodeåŠ é€Ÿç»˜åˆ¶">
<meta property="og:url" content="https://rosemoe.github.io/2021/10/02/android-render-node-using/index.html">
<meta property="og:site_name" content="Rosemoe&#39;s Blog">
<meta property="og:description" content="å†™åœ¨å‰é¢çš„åºŸè¯ç ”ç©¶RenderNodeçš„èµ·å› â€¦ä½œä¸ºä¸€ä¸ªä»£ç ç¼–è¾‘å™¨çš„å¼€å‘è€…ï¼Œæˆ‘ååˆ†å…³æ³¨æˆ‘å†™çš„Viewçš„ç»˜åˆ¶é€Ÿåº¦ã€‚äºæ˜¯å›½åº†èŠ‚æ”¾å‡ï¼Œå¿ƒè¡€æ¥æ½®æµ‹è¯•è‡ªå·±ç¼–è¾‘å™¨å’ŒEditTextç»˜åˆ¶çš„æ€§èƒ½ã€‚å‘ç°ä¸€æ®µä»£ç ï¼Œåœ¨ä¸¤ä¸ªViewä¸­æ˜¾ç¤ºå‡ºæ¥å‡ ä¹æ²¡ä»€ä¹ˆåŒºåˆ«ï¼Œä½†æ˜¯TextViewçš„ç»˜åˆ¶æ¯”å’±å¿«å¤šäº†ï¼Œè¿™æ˜¯ä¸ºä»€ä¹ˆå‘¢ï¼Ÿæˆ‘å°è¯•ä¸€æ®µä¸€æ®µæ³¨é‡Šè‡ªå·±çš„é™¤äº†æ–‡æœ¬ä»¥å¤–å…ƒç´ çš„ç»˜åˆ¶ä»£ç ã€‚ä»å±è”½ä»£ç åŒºåˆ’çº¿ï¼Œåˆ°å±è”½ç©ºç™½å­—ç¬¦çš„ç»˜åˆ¶ï¼Œæœ€åç”šè‡³æŠŠä»£ç é«˜äº®éƒ½æ¢æˆ">
<meta property="og:locale" content="en_US">
<meta property="og:image" content="https://cdn.jsdelivr.net/gh/jerryc127/CDN@latest/cover/default_bg.png">
<meta property="article:published_time" content="2021-10-02T11:57:08.000Z">
<meta property="article:modified_time" content="2021-10-09T17:17:52.918Z">
<meta property="article:author" content="Rosemoe">
<meta property="article:tag" content="Android">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="https://cdn.jsdelivr.net/gh/jerryc127/CDN@latest/cover/default_bg.png"><link rel="shortcut icon" href="/img/favicon.ico"><link rel="canonical" href="https://rosemoe.github.io/2021/10/02/android-render-node-using/"><link rel="preconnect" href="//cdn.jsdelivr.net"/><link rel="preconnect" href="//fonts.googleapis.com" crossorigin=""/><link rel="preconnect" href="//busuanzi.ibruce.info"/><link rel="stylesheet" href="/css/index.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free/css/all.min.css" media="print" onload="this.media='all'"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/node-snackbar/dist/snackbar.min.css" media="print" onload="this.media='all'"><link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Titillium+Web" media="print" onload="this.media='all'"><script>const GLOBAL_CONFIG = { 
  root: '/',
  algolia: undefined,
  localSearch: undefined,
  translate: undefined,
  noticeOutdate: undefined,
  highlight: {"plugin":"highlighjs","highlightCopy":true,"highlightLang":true,"highlightHeightLimit":false},
  copy: {
    success: 'Copy successfully',
    error: 'Copy error',
    noSupport: 'The browser does not support'
  },
  relativeDate: {
    homepage: false,
    post: false
  },
  runtime: 'days',
  date_suffix: {
    just: 'Just',
    min: 'minutes ago',
    hour: 'hours ago',
    day: 'days ago',
    month: 'months ago'
  },
  copyright: undefined,
  lightbox: 'fancybox',
  Snackbar: {"chs_to_cht":"Traditional Chinese Activated Manually","cht_to_chs":"Simplified Chinese Activated Manually","day_to_night":"Dark Mode Activated Manually","night_to_day":"Light Mode Activated Manually","bgLight":"#49b1f5","bgDark":"#121212","position":"bottom-left"},
  source: {
    jQuery: 'https://cdn.jsdelivr.net/npm/jquery@latest/dist/jquery.min.js',
    justifiedGallery: {
      js: 'https://cdn.jsdelivr.net/npm/justifiedGallery/dist/js/jquery.justifiedGallery.min.js',
      css: 'https://cdn.jsdelivr.net/npm/justifiedGallery/dist/css/justifiedGallery.min.css'
    },
    fancybox: {
      js: 'https://cdn.jsdelivr.net/npm/@fancyapps/fancybox@latest/dist/jquery.fancybox.min.js',
      css: 'https://cdn.jsdelivr.net/npm/@fancyapps/fancybox@latest/dist/jquery.fancybox.min.css'
    }
  },
  isPhotoFigcaption: false,
  islazyload: true,
  isanchor: false
}</script><script id="config-diff">var GLOBAL_CONFIG_SITE = {
  title: 'ä½¿ç”¨Android RenderNodeåŠ é€Ÿç»˜åˆ¶',
  isPost: true,
  isHome: false,
  isHighlightShrink: false,
  isToc: true,
  postUpdate: '2021-10-10 01:17:52'
}</script><noscript><style type="text/css">
  #nav {
    opacity: 1
  }
  .justified-gallery img {
    opacity: 1
  }

  #recent-posts time,
  #post-meta time {
    display: inline !important
  }
</style></noscript><script>(win=>{
    win.saveToLocal = {
      set: function setWithExpiry(key, value, ttl) {
        if (ttl === 0) return
        const now = new Date()
        const expiryDay = ttl * 86400000
        const item = {
          value: value,
          expiry: now.getTime() + expiryDay,
        }
        localStorage.setItem(key, JSON.stringify(item))
      },

      get: function getWithExpiry(key) {
        const itemStr = localStorage.getItem(key)

        if (!itemStr) {
          return undefined
        }
        const item = JSON.parse(itemStr)
        const now = new Date()

        if (now.getTime() > item.expiry) {
          localStorage.removeItem(key)
          return undefined
        }
        return item.value
      }
    }
  
    win.getScript = url => new Promise((resolve, reject) => {
      const script = document.createElement('script')
      script.src = url
      script.async = true
      script.onerror = reject
      script.onload = script.onreadystatechange = function() {
        const loadState = this.readyState
        if (loadState && loadState !== 'loaded' && loadState !== 'complete') return
        script.onload = script.onreadystatechange = null
        resolve()
      }
      document.head.appendChild(script)
    })
  
      win.activateDarkMode = function () {
        document.documentElement.setAttribute('data-theme', 'dark')
        if (document.querySelector('meta[name="theme-color"]') !== null) {
          document.querySelector('meta[name="theme-color"]').setAttribute('content', '#0d0d0d')
        }
      }
      win.activateLightMode = function () {
        document.documentElement.setAttribute('data-theme', 'light')
        if (document.querySelector('meta[name="theme-color"]') !== null) {
          document.querySelector('meta[name="theme-color"]').setAttribute('content', '#ffffff')
        }
      }
      const t = saveToLocal.get('theme')
    
          if (t === 'dark') activateDarkMode()
          else if (t === 'light') activateLightMode()
        
      const asideStatus = saveToLocal.get('aside-status')
      if (asideStatus !== undefined) {
        if (asideStatus === 'hide') {
          document.documentElement.classList.add('hide-aside')
        } else {
          document.documentElement.classList.remove('hide-aside')
        }
      }
    
    const detectApple = () => {
      if (GLOBAL_CONFIG_SITE.isHome && /iPad|iPhone|iPod|Macintosh/.test(navigator.userAgent)){
        document.documentElement.classList.add('apple')
      }
    }
    detectApple()
    })(window)</script><meta name="generator" content="Hexo 5.4.0"></head><body><div id="loading-box"><div class="loading-left-bg"></div><div class="loading-right-bg"></div><div class="spinner-box"><div class="configure-border-1"><div class="configure-core"></div></div><div class="configure-border-2"><div class="configure-core"></div></div><div class="loading-word">Loading...</div></div></div><div id="sidebar"><div id="menu-mask"></div><div id="sidebar-menus"><div class="avatar-img is-center"><img src= "data:image/gif;base64,R0lGODdhAQABAPAAAMPDwwAAACwAAAAAAQABAAACAkQBADs=" data-lazy-src="/img/head.jpg" onerror="onerror=null;src='/img/friend_404.gif'" alt="avatar"/></div><div class="site-data"><div class="data-item is-center"><div class="data-item-link"><a href="/archives/"><div class="headline">Articles</div><div class="length-num">8</div></a></div></div><div class="data-item is-center"><div class="data-item-link"><a href="/tags/"><div class="headline">Tags</div><div class="length-num">5</div></a></div></div><div class="data-item is-center"><div class="data-item-link"><a href="/categories/"><div class="headline">Categories</div><div class="length-num">3</div></a></div></div></div><hr/><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fa fa-home"></i><span> ä¸»é¡µ</span></a></div><div class="menus_item"><a class="site-page" href="/archives/"><i class="fa-fw fa fa-archive"></i><span> å½’æ¡£</span></a></div><div class="menus_item"><a class="site-page" href="/tags/"><i class="fa-fw fa fa-tags"></i><span> æ ‡ç­¾</span></a></div><div class="menus_item"><a class="site-page" href="/categories/"><i class="fa-fw fa fa-folder-open"></i><span> åˆ†ç±»</span></a></div><div class="menus_item"><a class="site-page" href="/link/"><i class="fa-fw fa fa-link"></i><span> å‹æƒ…é“¾æ¥</span></a></div><div class="menus_item"><a class="site-page" href="/about/"><i class="fa-fw fa fa-heart"></i><span> å…³äº</span></a></div></div></div></div><div class="post" id="body-wrap"><header class="not-top-img" id="page-header"><nav id="nav"><span id="blog_name"><a id="site-name" href="/">Rosemoe's Blog</a></span><div id="menus"><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fa fa-home"></i><span> ä¸»é¡µ</span></a></div><div class="menus_item"><a class="site-page" href="/archives/"><i class="fa-fw fa fa-archive"></i><span> å½’æ¡£</span></a></div><div class="menus_item"><a class="site-page" href="/tags/"><i class="fa-fw fa fa-tags"></i><span> æ ‡ç­¾</span></a></div><div class="menus_item"><a class="site-page" href="/categories/"><i class="fa-fw fa fa-folder-open"></i><span> åˆ†ç±»</span></a></div><div class="menus_item"><a class="site-page" href="/link/"><i class="fa-fw fa fa-link"></i><span> å‹æƒ…é“¾æ¥</span></a></div><div class="menus_item"><a class="site-page" href="/about/"><i class="fa-fw fa fa-heart"></i><span> å…³äº</span></a></div></div><div id="toggle-menu"><a class="site-page"><i class="fas fa-bars fa-fw"></i></a></div></div></nav></header><main class="layout" id="content-inner"><div id="post"><div id="post-info"><h1 class="post-title">ä½¿ç”¨Android RenderNodeåŠ é€Ÿç»˜åˆ¶</h1><div id="post-meta"><div class="meta-firstline"><span class="post-meta-date"><i class="far fa-calendar-alt fa-fw post-meta-icon"></i><span class="post-meta-label">Created</span><time class="post-meta-date-created" datetime="2021-10-02T11:57:08.000Z" title="Created 2021-10-02 19:57:08">2021-10-02</time><span class="post-meta-separator">|</span><i class="fas fa-history fa-fw post-meta-icon"></i><span class="post-meta-label">Updated</span><time class="post-meta-date-updated" datetime="2021-10-09T17:17:52.918Z" title="Updated 2021-10-10 01:17:52">2021-10-10</time></span><span class="post-meta-categories"><span class="post-meta-separator">|</span><i class="fas fa-inbox fa-fw post-meta-icon"></i><a class="post-meta-categories" href="/categories/Android/">Android</a></span></div><div class="meta-secondline"><span class="post-meta-separator">|</span><span class="post-meta-pv-cv" id="" data-flag-title="ä½¿ç”¨Android RenderNodeåŠ é€Ÿç»˜åˆ¶"><i class="far fa-eye fa-fw post-meta-icon"></i><span class="post-meta-label">Post View:</span><span id="busuanzi_value_page_pv"></span></span></div></div></div><article class="post-content" id="article-container"><h2 id="å†™åœ¨å‰é¢çš„åºŸè¯"><a href="#å†™åœ¨å‰é¢çš„åºŸè¯" class="headerlink" title="å†™åœ¨å‰é¢çš„åºŸè¯"></a>å†™åœ¨å‰é¢çš„åºŸè¯</h2><h3 id="ç ”ç©¶RenderNodeçš„èµ·å› â€¦"><a href="#ç ”ç©¶RenderNodeçš„èµ·å› â€¦" class="headerlink" title="ç ”ç©¶RenderNodeçš„èµ·å› â€¦"></a>ç ”ç©¶RenderNodeçš„èµ·å› â€¦</h3><p>ä½œä¸ºä¸€ä¸ªä»£ç ç¼–è¾‘å™¨çš„å¼€å‘è€…ï¼Œæˆ‘ååˆ†å…³æ³¨æˆ‘å†™çš„Viewçš„ç»˜åˆ¶é€Ÿåº¦ã€‚<br>äºæ˜¯å›½åº†èŠ‚æ”¾å‡ï¼Œå¿ƒè¡€æ¥æ½®æµ‹è¯•è‡ªå·±ç¼–è¾‘å™¨å’ŒEditTextç»˜åˆ¶çš„æ€§èƒ½ã€‚å‘ç°ä¸€æ®µä»£ç ï¼Œåœ¨ä¸¤ä¸ªViewä¸­æ˜¾ç¤ºå‡ºæ¥å‡ ä¹æ²¡ä»€ä¹ˆåŒºåˆ«ï¼Œä½†æ˜¯TextViewçš„ç»˜åˆ¶æ¯”å’±å¿«å¤šäº†ï¼Œè¿™æ˜¯ä¸ºä»€ä¹ˆå‘¢ï¼Ÿæˆ‘å°è¯•ä¸€æ®µä¸€æ®µæ³¨é‡Šè‡ªå·±çš„é™¤äº†æ–‡æœ¬ä»¥å¤–å…ƒç´ çš„ç»˜åˆ¶ä»£ç ã€‚ä»å±è”½ä»£ç åŒºåˆ’çº¿ï¼Œåˆ°å±è”½ç©ºç™½å­—ç¬¦çš„ç»˜åˆ¶ï¼Œæœ€åç”šè‡³æŠŠä»£ç é«˜äº®éƒ½æ¢æˆäº†æ™®æ™®é€šé€šçš„æ–‡æœ¬ç»˜åˆ¶ï¼Œä½†æ˜¯å°±æ˜¯æ¯”ä¸ä¸ŠEditTextã€‚ç¬”è€…ä¸€ä¸‹å­å°±ååˆ†çº³é—·äº†ï¼Œäºæ˜¯å¼€å§‹æ‘¸TextViewçš„ç»˜åˆ¶éƒ¨åˆ†ã€‚</p>
<h3 id="æ‘¸ç´¢TextViewæºç â€¦"><a href="#æ‘¸ç´¢TextViewæºç â€¦" class="headerlink" title="æ‘¸ç´¢TextViewæºç â€¦"></a>æ‘¸ç´¢TextViewæºç â€¦</h3><p>ä¸‹é¢ä»¥Andoird Qçš„æºç ä¸ºä¾‹ã€‚<br>æ‰“å¼€<code>onDraw()</code>æ–¹æ³•ç¿»äº†ä¸€ä¼šï¼Œçœ‹åˆ°äº†è°ƒç”¨<code>Layout</code>ç»˜åˆ¶çš„ä»£ç ï¼Œä¸è¿‡ä¼´éšç€çš„è¿˜æœ‰<code>mEditor</code>:</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">Path highlight = getUpdatedHighlightPath();</span><br><span class="line"><span class="keyword">if</span> (mEditor != <span class="keyword">null</span>) &#123;</span><br><span class="line">    mEditor.onDraw(canvas, layout, highlight, mHighlightPaint, cursorOffsetVertical);</span><br><span class="line">&#125; <span class="keyword">else</span> &#123;</span><br><span class="line">    layout.draw(canvas, highlight, mHighlightPaint, cursorOffsetVertical);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p><code>mEditor</code>æ˜¯åœ¨TextViewèƒ½ç¼–è¾‘æ–‡æœ¬çš„æ—¶å€™åˆ›å»ºçš„ï¼Œæ˜¾ç„¶æˆ‘åº”è¯¥çœ‹Editor.javaäº†<del>ï¼ˆä½†æ˜¯æˆ‘è¿˜æ˜¯å…ˆçœ‹äº†ä¸€ä¸‹Layoutï¼Œå¯èƒ½æˆ‘æ˜¯sbå§ï¼‰</del><br>ç„¶åè½¬åˆ°<code>Editor#onDraw</code>:<br>æœ¬æ¥ä»¥ä¸ºä¼šå¾ˆé•¿å´æ„å¤–åœ°çŸ­ï¼Œä¸€ä¸‹å­å°±çœ‹åˆ°å†æ¬¡è°ƒæ–¹æ³•ç»˜åˆ¶ï¼š</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">if</span> (mTextView.canHaveDisplayList() &amp;&amp; canvas.isHardwareAccelerated()) &#123;</span><br><span class="line">    drawHardwareAccelerated(canvas, layout, highlight, highlightPaint,</span><br><span class="line">            cursorOffsetVertical);</span><br><span class="line">&#125; <span class="keyword">else</span> &#123;</span><br><span class="line">    layout.draw(canvas, highlight, highlightPaint, cursorOffsetVertical);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p><code>HardwareAccelerated</code>å®åœ¨æ˜¯ä¸€ä¸ªæ•æ„Ÿçš„å­—çœ¼ï¼Œäºæ˜¯åˆçœ‹<code>Editor#drawHardwareAccelerated</code>,è¿½è¸ªåˆ°<code>drawHardwareAcceleratedInner</code>:</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br></pre></td><td class="code"><pre><span class="line">RenderNode blockDisplayList = mTextRenderNodes[blockIndex].renderNode;</span><br><span class="line"><span class="keyword">if</span> (mTextRenderNodes[blockIndex].needsToBeShifted || blockDisplayListIsInvalid) &#123;</span><br><span class="line">    <span class="keyword">final</span> <span class="keyword">int</span> blockBeginLine = blockInfoIndex == <span class="number">0</span> ?</span><br><span class="line">            <span class="number">0</span> : blockEndLines[blockInfoIndex - <span class="number">1</span>] + <span class="number">1</span>;</span><br><span class="line">    <span class="keyword">final</span> <span class="keyword">int</span> top = layout.getLineTop(blockBeginLine);</span><br><span class="line">    <span class="keyword">final</span> <span class="keyword">int</span> bottom = layout.getLineBottom(blockEndLine);</span><br><span class="line">    <span class="keyword">int</span> left = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">int</span> right = mTextView.getWidth();</span><br><span class="line">    <span class="keyword">if</span> (mTextView.getHorizontallyScrolling()) &#123;</span><br><span class="line">        <span class="keyword">float</span> min = Float.MAX_VALUE;</span><br><span class="line">        <span class="keyword">float</span> max = Float.MIN_VALUE;</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> line = blockBeginLine; line &lt;= blockEndLine; line++) &#123;</span><br><span class="line">            min = Math.min(min, layout.getLineLeft(line));</span><br><span class="line">            max = Math.max(max, layout.getLineRight(line));</span><br><span class="line">        &#125;</span><br><span class="line">        left = (<span class="keyword">int</span>) min;</span><br><span class="line">        right = (<span class="keyword">int</span>) (max + <span class="number">0.5f</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// Rebuild display list if it is invalid</span></span><br><span class="line">    <span class="keyword">if</span> (blockDisplayListIsInvalid) &#123;</span><br><span class="line">        <span class="keyword">final</span> RecordingCanvas recordingCanvas = blockDisplayList.beginRecording(</span><br><span class="line">                right - left, bottom - top);</span><br><span class="line">        <span class="keyword">try</span> &#123;</span><br><span class="line">            <span class="comment">// drawText is always relative to TextView&#x27;s origin, this translation</span></span><br><span class="line">            <span class="comment">// brings this range of text back to the top left corner of the viewport</span></span><br><span class="line">            recordingCanvas.translate(-left, -top);</span><br><span class="line">            layout.drawText(recordingCanvas, blockBeginLine, blockEndLine);</span><br><span class="line">            mTextRenderNodes[blockIndex].isDirty = <span class="keyword">false</span>;</span><br><span class="line">            <span class="comment">// No need to untranslate, previous context is popped after</span></span><br><span class="line">            <span class="comment">// drawDisplayList</span></span><br><span class="line">        &#125; <span class="keyword">finally</span> &#123;</span><br><span class="line">            blockDisplayList.endRecording();</span><br><span class="line">            <span class="comment">// Same as drawDisplayList below, handled by our TextView&#x27;s parent</span></span><br><span class="line">            blockDisplayList.setClipToBounds(<span class="keyword">false</span>);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// Valid display list only needs to update its drawing location.</span></span><br><span class="line">    blockDisplayList.setLeftTopRightBottom(left, top, right, bottom);</span><br><span class="line">    mTextRenderNodes[blockIndex].needsToBeShifted = <span class="keyword">false</span>;</span><br><span class="line">&#125;</span><br><span class="line">((RecordingCanvas) canvas).drawRenderNode(blockDisplayList);</span><br></pre></td></tr></table></figure>
<p>çœ‹åˆ°DisplayListã€RenderNodeï¼Œæˆ‘æ„Ÿè§‰å¤§æœ‰æå¤´ã€‚ç»è¿‡ä¸€æ®µæ—¶é—´çš„ç¿»é˜…åï¼Œå‘ç°RenderNodeåœ¨Android Qï¼ˆAPI 29ï¼‰ä¸Šæˆä¸ºäº†å…¬å¼€çš„APIï¼Œä½äº<code>android.graphics</code>ä¸‹ã€‚åœ¨è¿™ä¹‹å‰ï¼ŒRenderNodeæ˜¯<code>android.view</code>ä¸‹çš„Hidden APIï¼Œè€Œä¸”çœ‹äº†ä¸€ä¸‹Android Lçš„ä»£ç å’ŒAndroid Pçš„ä»£ç ç›¸å·®è¿˜æŒºå¤§çš„ï¼Œåå°„ä¹Ÿä¸å¥½åå°„ã€‚ä¸è¿‡æˆ‘è¿˜æ˜¯å°è¯•åœ¨Android Rä¸Šä½¿ç”¨å®ƒã€‚</p>
<h2 id="RenderNode"><a href="#RenderNode" class="headerlink" title="RenderNode"></a>RenderNode</h2><p>åº”è¯¥æ²¡äººç¿»è¯‘æ–‡æ¡£å§ï¼Ÿç¨å¾®ç¿»è¯‘ä¸€ä¸‹â€¦</p>
<h3 id="æ–‡æ¡£"><a href="#æ–‡æ¡£" class="headerlink" title="æ–‡æ¡£"></a>æ–‡æ¡£</h3><p>RenderNodeå¯ç”¨äºæ„å»ºç¡¬ä»¶åŠ é€Ÿç»˜åˆ¶ä½“ç³»ã€‚æ¯ä¸ªRenderNodeæ—¢åŒ…å«ä¸€ä¸ªDisplayListä¹ŸåŒ…å«ä¸€ç³»åˆ—å½±å“å…¶DisplayListå¦‚ä½•ç»˜åˆ¶åœ¨å±å¹•ä¸Šçš„å±æ€§ã€‚RenderNodeåœ¨é»˜è®¤æƒ…å†µä¸‹åœ¨æ‰€æœ‰Viewä¸Šè¢«å†…éƒ¨ä½¿ç”¨ï¼Œè€Œå¹¶ä¸æ˜¯ç›´æ¥è¢«ä½¿ç”¨ã€‚<br>RenderNodeå¯ç”¨äºå°†ä¸€ä¸ªå¤æ‚çš„ç»˜åˆ¶åœºæ™¯åˆ†å¼€æˆä¸ºæ›´å°çš„éƒ¨åˆ†ã€‚è¿™äº›éƒ¨åˆ†å°±å¯ä»¥è¢«å•ç‹¬åœ°ä»¥æ›´å°åœ°å¼€é”€æ›´æ–°ã€‚æ›´æ–°è¿™ä¸€åœºæ™¯åœ°ä¸€éƒ¨åˆ†åªéœ€è¦æ›´æ–°å°‘æ•°çš„RenderNodeçš„DisplayListæˆ–è€…å±æ€§ï¼Œè€Œä¸æ˜¯é‡ç»˜æ‰€æœ‰ã€‚ä¸€ä¸ªRenderNodeåªéœ€è¦åœ¨å®ƒçš„å†…å®¹è¢«æ”¹å˜æ—¶é‡æ–°å½•åˆ¶å®ƒçš„DisplayListã€‚RenderNodeå¯ä»¥åœ¨ä¸é‡æ–°å½•åˆ¶çš„æƒ…å†µä¸‹é€šè¿‡å®ƒçš„å±æ€§è¿›è¡Œä¸€äº›å˜æ¢ã€‚<br>æ¯”å¦‚è¯´ï¼Œä¸€ä¸ªæ–‡æœ¬ç¼–è¾‘å™¨æˆ–è®¸ä¼šä¿å­˜æ¯ä¸€æ®µåˆ°å®ƒè‡ªå·±çš„RenderNodeä¸­ã€‚è¿™æ ·å½“ç”¨æˆ·æ’å…¥æˆ–åˆ é™¤ä¸€äº›å­—ç¬¦çš„æ—¶å€™ï¼Œåªæœ‰å—å½±å“çš„æ®µè½çš„DisplayListéœ€è¦è¢«é‡æ–°å½•åˆ¶ã€‚</p>
<h4 id="ç¡¬ä»¶åŠ é€Ÿ"><a href="#ç¡¬ä»¶åŠ é€Ÿ" class="headerlink" title="ç¡¬ä»¶åŠ é€Ÿ"></a>ç¡¬ä»¶åŠ é€Ÿ</h4><p>RenderNodeå¯ä»¥åœ¨<code>RecordingCanvas</code>ä¸Šè¢«ç»˜åˆ¶ã€‚è¿™ä¸å—è½¯ä»¶ç»˜åˆ¶æ”¯æŒã€‚è¯·ç¡®ä¿ä½ æ­£åœ¨ä½¿ç”¨æ¥ç»˜åˆ¶RenderNodeçš„Canvasæ—¶å¯ç”¨ç¡¬ä»¶åŠ é€Ÿçš„ã€‚ä½ å¯ä»¥é€šè¿‡<code>Canvas.isHardwareAccelerated()</code>æ¥ç¡®è®¤ç¡¬ä»¶åŠ é€Ÿæ˜¯å¦å¯ç”¨ã€‚</p>
<h4 id="åˆ›å»ºRenderNode"><a href="#åˆ›å»ºRenderNode" class="headerlink" title="åˆ›å»ºRenderNode"></a>åˆ›å»ºRenderNode</h4><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">RenderNode renderNode = <span class="keyword">new</span> RenderNode(<span class="string">&quot;myRenderNode&quot;</span>);</span><br><span class="line">renderNode.setPosition(<span class="number">0</span>, <span class="number">0</span>, <span class="number">50</span>, <span class="number">50</span>); <span class="comment">// è®¾ç½®å¤§å°ä¸º50*50</span></span><br><span class="line">RecordingCanvas canvas = renderNode.beginRecording();</span><br><span class="line"><span class="keyword">try</span> &#123;</span><br><span class="line">    <span class="comment">// åœ¨RenderNodeçš„Canvasä¸Šç»˜åˆ¶</span></span><br><span class="line">    canvas.drawRect(...);</span><br><span class="line">&#125; <span class="keyword">finally</span> &#123;</span><br><span class="line">    renderNode.endRecording();</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h4 id="åœ¨Viewä¸­ç»˜åˆ¶RenderNode"><a href="#åœ¨Viewä¸­ç»˜åˆ¶RenderNode" class="headerlink" title="åœ¨Viewä¸­ç»˜åˆ¶RenderNode"></a>åœ¨Viewä¸­ç»˜åˆ¶RenderNode</h4><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">protected</span> <span class="keyword">void</span> <span class="title">onDraw</span><span class="params">(Canvas canvas)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">if</span> (canvas.isHardwareAccelerated()) &#123;</span><br><span class="line">        <span class="comment">// æ£€æŸ¥RenderNodeæ˜¯å¦æœ‰æ˜¾ç¤ºåˆ—è¡¨ã€‚å¦‚æœæ²¡æœ‰ï¼Œå…ˆé‡æ–°ç»˜åˆ¶RenderNode</span></span><br><span class="line">        <span class="keyword">if</span> (!myRenderNode.hasDisplayList()) &#123;</span><br><span class="line">            updateDisplayList(myRenderNode);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="comment">// å°†RenderNodeç”»åˆ°Canvasä¸Š</span></span><br><span class="line">        canvas.drawRenderNode(myRenderNode);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h4 id="é‡Šæ”¾èµ„æº"><a href="#é‡Šæ”¾èµ„æº" class="headerlink" title="é‡Šæ”¾èµ„æº"></a>é‡Šæ”¾èµ„æº</h4><p>è¿™ä¸€æ­¥å¹¶ä¸æ˜¯å¿…é¡»çš„ï¼Œä½†æ˜¯å¦‚æœä½ æƒ³è¦å°½å¿«é‡Šæ”¾è¢«DisplayListå ç”¨çš„èµ„æºï¼Œæˆ‘ä»¬æ¨èä½ è¿™ä¹ˆåšã€‚æœ€ä¸»è¦çš„æ˜¯å®ƒæˆ–è®¸åŒ…å«çš„Bitmapã€‚</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// èˆå¼ƒDisplayListï¼Œé‡Šæ”¾æŒæœ‰çš„èµ„æº</span></span><br><span class="line">renderNode.discardDisplayList();</span><br></pre></td></tr></table></figure>
<h4 id="å±æ€§"><a href="#å±æ€§" class="headerlink" title="å±æ€§"></a>å±æ€§</h4><p>é™¤æ­¤ä»¥å¤–ï¼ŒRenderNodeæä¾›äº†è®¸å¤šå±æ€§ï¼Œæ¯”å¦‚<code>setScaleX(float)</code>å’Œ<code>setTranslationX(float)</code>ã€‚ä»–ä»¬å¯ä»¥ç”¨æ¥å½±å“ä¸€åˆ‡å·²ç»è®°å½•çš„ç»˜åˆ¶å‘½ä»¤ã€‚ä¾‹å¦‚ï¼Œè¿™äº›å±æ€§å¯ä»¥è¢«ç”¨æ¥ç§»åŠ¨å¤§é‡çš„å›¾åƒï¼Œè€Œä¸éœ€è¦é‡æ–°é€šè¿‡ä¸€ä¸ªä¸€ä¸ªå•ç‹¬è°ƒç”¨<code>canvas.drawBitmap()</code>æ¥å®ç°ã€‚</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">private</span> <span class="keyword">void</span> <span class="title">createDisplayList</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    mRenderNode = <span class="keyword">new</span> RenderNode(<span class="string">&quot;MyRenderNode&quot;</span>);</span><br><span class="line">    mRenderNode.setPosition(<span class="number">0</span>, <span class="number">0</span>, width, height);</span><br><span class="line">    RecordingCanvas canvas = mRenderNode.beginRecording();</span><br><span class="line">    <span class="keyword">try</span> &#123;</span><br><span class="line">        <span class="keyword">for</span> (Bitmap b : mBitmaps) &#123;</span><br><span class="line">            canvas.drawBitmap(b, <span class="number">0.0f</span>, <span class="number">0.0f</span>, <span class="keyword">null</span>);</span><br><span class="line">            canvas.translate(<span class="number">0.0f</span>, b.getHeight());</span><br><span class="line">        &#125;</span><br><span class="line">    &#125; <span class="keyword">finally</span> &#123;</span><br><span class="line">        mRenderNode.endRecording();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line">  </span><br><span class="line"><span class="function"><span class="keyword">protected</span> <span class="keyword">void</span> <span class="title">onDraw</span><span class="params">(Canvas canvas)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">if</span> (canvas.isHardwareAccelerated())</span><br><span class="line">        canvas.drawRenderNode(mRenderNode);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line">  </span><br><span class="line"><span class="function"><span class="keyword">private</span> <span class="keyword">void</span> <span class="title">moveContentBy</span><span class="params">(<span class="keyword">int</span> x)</span> </span>&#123;</span><br><span class="line">     <span class="comment">// è¿™å°†ç§»åŠ¨æ‰€æœ‰è®°å½•åœ¨RenderNodeä¸­çš„å›¾åƒå‘å³è¾¹xåƒç´ ï¼Œç„¶åé‡ç»˜è¿™ä¸ªView</span></span><br><span class="line">     <span class="comment">// æ‰€æœ‰è®°å½•çš„æ“ä½œä¸éœ€è¦è¢«é‡æ–°å‘è¡Œï¼Œåªæœ‰onDraw()ä¼šè¢«è°ƒç”¨è€Œä¸”å¾ˆå¿«å°±æ‰§è¡Œå®Œæˆ</span></span><br><span class="line">     mRenderNode.offsetLeftAndRight(x);</span><br><span class="line">     invalidate();</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>æ³¨ï¼šæ­¤å¤„ç¬”è€…è§‰å¾—ç”¨å¤„ä¸å¤§ï¼Œæ²¡ç¿»è¯‘<br>A few of the properties may at first appear redundant, such as setElevation(float) and setTranslationZ(float). The reason for these duplicates are to allow for a separation between static &amp; transient usages. For example consider a button that raises from 2dp to 8dp when pressed. To achieve that an application may decide to setElevation(2dip), and then on press to animate setTranslationZ to 6dip. Combined this achieves the final desired 8dip value, but the animation need only concern itself with animating the lift from press without needing to know the initial starting value. setTranslationX(float) and setTranslationY(float) are similarly provided for animation uses despite the functional overlap with setPosition(Rect).<br>The RenderNodeâ€™s transform matrix is computed at render time as follows:</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">Matrix transform = <span class="keyword">new</span> Matrix();</span><br><span class="line">transform.setTranslate(renderNode.getTranslationX(), renderNode.getTranslationY());</span><br><span class="line">transform.preRotate(renderNode.getRotationZ(),</span><br><span class="line">        renderNode.getPivotX(), renderNode.getPivotY());</span><br><span class="line">transform.preScale(renderNode.getScaleX(), renderNode.getScaleY(),</span><br><span class="line">        renderNode.getPivotX(), renderNode.getPivotY());</span><br></pre></td></tr></table></figure>
<p>The current canvas transform matrix, which is translated to the RenderNodeâ€™s position, is then multiplied by the RenderNodeâ€™s transform matrix. Therefore the ordering of calling property setters does not affect the result. That is to say that:</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">renderNode.setTranslationX(<span class="number">100</span>);</span><br><span class="line">renderNode.setScaleX(<span class="number">100</span>);</span><br></pre></td></tr></table></figure>
<p>is equivalent to:</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">renderNode.setScaleX(<span class="number">100</span>);</span><br><span class="line">renderNode.setTranslationX(<span class="number">100</span>);</span><br></pre></td></tr></table></figure>
<h4 id="çº¿ç¨‹è°ƒåº¦"><a href="#çº¿ç¨‹è°ƒåº¦" class="headerlink" title="çº¿ç¨‹è°ƒåº¦"></a>çº¿ç¨‹è°ƒåº¦</h4><p>RenderNodeå¯ä»¥åœ¨ä»»ä½•çº¿ç¨‹è¢«åˆ›å»ºå¹¶ä½¿ç”¨ï¼Œä½†å®ƒä¸æ˜¯çº¿ç¨‹å®‰å…¨çš„ã€‚åªæœ‰ä¸€ä¸ªçº¿ç¨‹å¯ä»¥åœ¨æŸä¸€æ—¶é—´ä¸RenderNodeäº¤äº’ã€‚å»ºè®®RenderNodeåªåœ¨ç›¸åŒçš„çº¿ç¨‹è¢«ä½¿ç”¨ï¼Œå³å®ƒå°†è¦è¢«ç»˜åˆ¶çš„çº¿ç¨‹ã€‚æ¯”å¦‚è‡ªå®šä¹‰Viewä½¿ç”¨RenderNodeæ—¶ï¼Œåªåœ¨UIçº¿ç¨‹ä½¿ç”¨RenderNodeã€‚<br>RenderNodeçš„è®¸å¤šæ–¹æ³•è¿”å›ä¸€ä¸ªå¸ƒå°”å€¼æ¥æŒ‡ç¤ºå®ƒæ˜¯å¦éœ€è¦è¢«é‡ç»˜ã€‚å…¸å‹çš„æ¯”å¦‚ï¼š</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">translateTo</span><span class="params">(<span class="keyword">int</span> x, <span class="keyword">int</span> y)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">boolean</span> needsUpdate = myRenderNode.setTranslationX(x);</span><br><span class="line">    needsUpdate |= myRenderNode.setTranslationY(y);</span><br><span class="line">    <span class="keyword">if</span> (needsUpdate) &#123;</span><br><span class="line">        myOwningView.invalidate();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>è¿™ä¼šæ¯”æ˜¾å¼åœ°é€šè¿‡<code>getTransationX()</code>æ¯”è¾ƒæ£€æŸ¥å¿«ï¼Œå› ä¸ºè¿™æœ€å°åŒ–äº†ç§»åŠ¨åˆ°åœ°JNIå¼€é”€ã€‚æ˜¯å¦éœ€è¦é‡ç»˜å–å†³äºè¿™ä¸ªRenderNodeå¦‚ä½•è¢«ç»˜åˆ¶ã€‚å¦‚æœå®ƒè¢«ç»˜åˆ¶åˆ°Viewä¸Šï¼Œé‚£ä¹ˆåªéœ€è¦é‡ç»˜Viewå°±è¡Œäº†ã€‚å¦‚æœå®ƒè¢«ç»˜åˆ¶åˆ°ä¸€ä¸ªç›´æ¥ä½¿ç”¨<code>Surface.lockHardwareCanvas()</code>çš„Canvasä¸Šï¼Œé‚£ä¹ˆå®ƒéœ€è¦è¢«é‡ç»˜ï¼Œé€šè¿‡è°ƒç”¨<code>Surface.lockHardwareCanvas()</code>ï¼Œç»˜åˆ¶æ ¹RenderNodeæˆ–è€…å…¶å®ƒè¢«é¡¶çº§å†…å®¹éœ€è¦çš„ï¼Œå¹¶è°ƒç”¨<code>Surface.unlockCanvasAndPost(canvas)</code>ã€‚</p>
<h3 id="å‡ ä¸ªæç¤º"><a href="#å‡ ä¸ªæç¤º" class="headerlink" title="å‡ ä¸ªæç¤º"></a>å‡ ä¸ªæç¤º</h3><h4 id="æ„é€ å™¨"><a href="#æ„é€ å™¨" class="headerlink" title="æ„é€ å™¨"></a>æ„é€ å™¨</h4><p>æ„é€ å™¨çš„nameå¯ä»¥éšæ„ï¼Œnullä¹Ÿå¯ä»¥ã€‚æ–‡æ¡£è¯´æ˜¯è°ƒè¯•ç”¨çš„ã€‚</p>
<h4 id="ç»˜åˆ¶"><a href="#ç»˜åˆ¶" class="headerlink" title="ç»˜åˆ¶"></a>ç»˜åˆ¶</h4><p>ç»˜åˆ¶åˆ°Viewçš„Canvasä¸Šä¹‹å‰ï¼Œä¸€å®šè¦è®°å¾—æ£€æŸ¥è¿™ä¸ªCanvasæ˜¯å¦å¼€å¯ç¡¬ä»¶åŠ é€Ÿï¼Œå¦‚æœæ²¡æœ‰å¼€å¯ï¼Œé‚£ä¹ˆRenderNodeæ— æ³•è¢«ç»˜åˆ¶å¹¶ä¸”ä¼šæŠ›å‡ºUnsupportedOperationExceptionã€‚<br>åŒæ—¶ä¹Ÿè¦æ£€æŸ¥RenderNodeæ˜¯å¦è¿˜æœ‰DisplayListï¼Œé€šè¿‡<code>RenderNode.hasDisplayList()</code>ã€‚å¦‚æœè¿”å›falseï¼Œéœ€è¦é‡æ–°å½•åˆ¶åœ¨RenderNodeä¸Šçš„ç»˜åˆ¶æ“ä½œï¼Œå¦åˆ™ç»˜åˆ¶å‡ºçš„RenderNodeæ˜¯ç©ºçš„ã€‚<br>RenderNodeä¼¼ä¹å¦‚æœåœ¨ä¸Šä¸€æ¬¡ç»˜åˆ¶æ“ä½œä¸­æ²¡æœ‰è¢«ä½¿ç”¨ï¼Œå…¶DisplayListå°±ä¼šè¢«å›æ”¶ï¼Œéœ€è¦é‡æ–°å½•åˆ¶æ“ä½œã€‚ç¬”è€…å› ä¸ºä¸çŸ¥é“è¿™ä¸ªå‚»å‚»åœ°è°ƒäº†ä¸€ä¸ªå°æ—¶ï¼Œæœ€åæ‰å‘ç°æ˜¯æ²¡æœ‰DisplayListã€‚</p>
<h4 id="å®ä¾‹"><a href="#å®ä¾‹" class="headerlink" title="å®ä¾‹"></a>å®ä¾‹</h4><p><a target="_blank" rel="noopener" href="https://github.com/Rosemoe/CodeEditor/blob/main/editor/src/main/java/io/github/rosemoe/sora/widget/HwAcceleratedRenderer.java">HwAcceleratedRenderer.java</a></p>
</article><div class="post-copyright"><div class="post-copyright__author"><span class="post-copyright-meta">Author: </span><span class="post-copyright-info"><a href="mailto:undefined">Rosemoe</a></span></div><div class="post-copyright__type"><span class="post-copyright-meta">Link: </span><span class="post-copyright-info"><a href="https://rosemoe.github.io/2021/10/02/android-render-node-using/">https://rosemoe.github.io/2021/10/02/android-render-node-using/</a></span></div><div class="post-copyright__notice"><span class="post-copyright-meta">Copyright Notice: </span><span class="post-copyright-info">All articles in this blog are licensed under <a target="_blank" rel="noopener" href="https://creativecommons.org/licenses/by-nc-sa/4.0/">CC BY-NC-SA 4.0</a> unless stating additionally.</span></div></div><div class="tag_share"><div class="post-meta__tag-list"><a class="post-meta__tags" href="/tags/Android/">Android</a></div><div class="post_share"><div class="social-share" data-image="https://cdn.jsdelivr.net/gh/jerryc127/CDN@latest/cover/default_bg.png" data-sites="facebook,twitter,wechat,weibo,qq"></div><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/social-share.js/dist/css/share.min.css" media="print" onload="this.media='all'"><script src="https://cdn.jsdelivr.net/npm/social-share.js/dist/js/social-share.min.js" defer></script></div></div><nav class="pagination-post" id="pagination"><div class="next-post pull-full"><a href="/2021/08/22/editor-get-started/"><img class="next-cover" src= "data:image/gif;base64,R0lGODdhAQABAPAAAMPDwwAAACwAAAAAAQABAAACAkQBADs=" data-lazy-src="https://cdn.jsdelivr.net/gh/jerryc127/CDN@latest/cover/default_bg.png" onerror="onerror=null;src='/img/404.jpg'" alt="cover of next post"><div class="pagination-info"><div class="label">Next Post</div><div class="next_info">Get started with your Android project</div></div></a></div></nav><div class="relatedPosts"><div class="headline"><i class="fas fa-thumbs-up fa-fw"></i><span> Related Articles</span></div><div class="relatedPosts-list"><div><a href="/2020/04/25/android-dev-mistake/" title="è®°Androidå¼€å‘ä¸­ä¸€ä¸ªå‘ - ViewRootImpl"><img class="cover" src= "data:image/gif;base64,R0lGODdhAQABAPAAAMPDwwAAACwAAAAAAQABAAACAkQBADs=" data-lazy-src="https://cdn.jsdelivr.net/gh/jerryc127/CDN@latest/cover/default_bg.png" alt="cover"><div class="content is-center"><div class="date"><i class="far fa-calendar-alt fa-fw"></i> 2020-04-25</div><div class="title">è®°Androidå¼€å‘ä¸­ä¸€ä¸ªå‘ - ViewRootImpl</div></div></a></div><div><a href="/2020/02/15/highlight-editor-creation/" title="ä¸€ä¸ªé«˜äº®ç¼–è¾‘æ¡†çš„æ„å»ºå†ç¨‹"><img class="cover" src= "data:image/gif;base64,R0lGODdhAQABAPAAAMPDwwAAACwAAAAAAQABAAACAkQBADs=" data-lazy-src="https://cdn.jsdelivr.net/gh/jerryc127/CDN@latest/cover/default_bg.png" alt="cover"><div class="content is-center"><div class="date"><i class="far fa-calendar-alt fa-fw"></i> 2020-02-15</div><div class="title">ä¸€ä¸ªé«˜äº®ç¼–è¾‘æ¡†çš„æ„å»ºå†ç¨‹</div></div></a></div><div><a href="/2020/10/30/image-to-qq-painting/" title="ğŸ‘´ç©çˆ†QQæ¶‚é¸¦"><img class="cover" src= "data:image/gif;base64,R0lGODdhAQABAPAAAMPDwwAAACwAAAAAAQABAAACAkQBADs=" data-lazy-src="https://cdn.jsdelivr.net/gh/jerryc127/CDN@latest/cover/default_bg.png" alt="cover"><div class="content is-center"><div class="date"><i class="far fa-calendar-alt fa-fw"></i> 2020-10-30</div><div class="title">ğŸ‘´ç©çˆ†QQæ¶‚é¸¦</div></div></a></div><div><a href="/2020/08/24/what-is-slow-in-text-warrior/" title="Text Warriorä¸­ä¸€äº›ä¸è¶³ä¹‹å¤„"><img class="cover" src= "data:image/gif;base64,R0lGODdhAQABAPAAAMPDwwAAACwAAAAAAQABAAACAkQBADs=" data-lazy-src="https://cdn.jsdelivr.net/gh/jerryc127/CDN@latest/cover/default_bg.png" alt="cover"><div class="content is-center"><div class="date"><i class="far fa-calendar-alt fa-fw"></i> 2020-08-24</div><div class="title">Text Warriorä¸­ä¸€äº›ä¸è¶³ä¹‹å¤„</div></div></a></div></div></div></div><div class="aside-content" id="aside-content"><div class="card-widget card-info"><div class="is-center"><div class="avatar-img"><img src= "data:image/gif;base64,R0lGODdhAQABAPAAAMPDwwAAACwAAAAAAQABAAACAkQBADs=" data-lazy-src="/img/head.jpg" onerror="this.onerror=null;this.src='/img/friend_404.gif'" alt="avatar"/></div><div class="author-info__name">Rosemoe</div><div class="author-info__description">A lazy Android developer</div></div><div class="card-info-data"><div class="card-info-data-item is-center"><a href="/archives/"><div class="headline">Articles</div><div class="length-num">8</div></a></div><div class="card-info-data-item is-center"><a href="/tags/"><div class="headline">Tags</div><div class="length-num">5</div></a></div><div class="card-info-data-item is-center"><a href="/categories/"><div class="headline">Categories</div><div class="length-num">3</div></a></div></div><a class="button--animated" id="card-info-btn" target="_blank" rel="noopener" href="https://github.com/Rosemoe"><i class="fab fa-github"></i><span>Follow Me</span></a><div class="card-info-social-icons is-center"><a class="social-icon" href="https://github.com/Rosemoe" target="_blank" title="Github"><i class="fab fa-github"></i></a><a class="social-icon" href="mailto:2073412493@qq.com" target="_blank" title="Email"><i class="fas fa-envelope"></i></a></div></div><div class="card-widget card-announcement"><div class="item-headline"><i class="fas fa-bullhorn card-announcement-animation"></i><span>Announcement</span></div><div class="announcement_content">Welcome to Rosemoe's Blog ~</div></div><div class="sticky_layout"><div class="card-widget" id="card-toc"><div class="item-headline"><i class="fas fa-stream"></i><span>Catalog</span></div><div class="toc-content"><ol class="toc"><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%86%99%E5%9C%A8%E5%89%8D%E9%9D%A2%E7%9A%84%E5%BA%9F%E8%AF%9D"><span class="toc-number">1.</span> <span class="toc-text">å†™åœ¨å‰é¢çš„åºŸè¯</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E7%A0%94%E7%A9%B6RenderNode%E7%9A%84%E8%B5%B7%E5%9B%A0%E2%80%A6"><span class="toc-number">1.1.</span> <span class="toc-text">ç ”ç©¶RenderNodeçš„èµ·å› â€¦</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%91%B8%E7%B4%A2TextView%E6%BA%90%E7%A0%81%E2%80%A6"><span class="toc-number">1.2.</span> <span class="toc-text">æ‘¸ç´¢TextViewæºç â€¦</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#RenderNode"><span class="toc-number">2.</span> <span class="toc-text">RenderNode</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%96%87%E6%A1%A3"><span class="toc-number">2.1.</span> <span class="toc-text">æ–‡æ¡£</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E7%A1%AC%E4%BB%B6%E5%8A%A0%E9%80%9F"><span class="toc-number">2.1.1.</span> <span class="toc-text">ç¡¬ä»¶åŠ é€Ÿ</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E5%88%9B%E5%BB%BARenderNode"><span class="toc-number">2.1.2.</span> <span class="toc-text">åˆ›å»ºRenderNode</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E5%9C%A8View%E4%B8%AD%E7%BB%98%E5%88%B6RenderNode"><span class="toc-number">2.1.3.</span> <span class="toc-text">åœ¨Viewä¸­ç»˜åˆ¶RenderNode</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E9%87%8A%E6%94%BE%E8%B5%84%E6%BA%90"><span class="toc-number">2.1.4.</span> <span class="toc-text">é‡Šæ”¾èµ„æº</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E5%B1%9E%E6%80%A7"><span class="toc-number">2.1.5.</span> <span class="toc-text">å±æ€§</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E7%BA%BF%E7%A8%8B%E8%B0%83%E5%BA%A6"><span class="toc-number">2.1.6.</span> <span class="toc-text">çº¿ç¨‹è°ƒåº¦</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%87%A0%E4%B8%AA%E6%8F%90%E7%A4%BA"><span class="toc-number">2.2.</span> <span class="toc-text">å‡ ä¸ªæç¤º</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E6%9E%84%E9%80%A0%E5%99%A8"><span class="toc-number">2.2.1.</span> <span class="toc-text">æ„é€ å™¨</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E7%BB%98%E5%88%B6"><span class="toc-number">2.2.2.</span> <span class="toc-text">ç»˜åˆ¶</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E5%AE%9E%E4%BE%8B"><span class="toc-number">2.2.3.</span> <span class="toc-text">å®ä¾‹</span></a></li></ol></li></ol></li></ol></div></div><div class="card-widget card-recent-post"><div class="item-headline"><i class="fas fa-history"></i><span>Recent Post</span></div><div class="aside-list"><div class="aside-list-item no-cover"><div class="content"><a class="title" href="/2021/10/02/android-render-node-using/" title="ä½¿ç”¨Android RenderNodeåŠ é€Ÿç»˜åˆ¶">ä½¿ç”¨Android RenderNodeåŠ é€Ÿç»˜åˆ¶</a><time datetime="2021-10-02T11:57:08.000Z" title="Created 2021-10-02 19:57:08">2021-10-02</time></div></div><div class="aside-list-item no-cover"><div class="content"><a class="title" href="/2021/08/22/editor-get-started/" title="Get started with your Android project">Get started with your Android project</a><time datetime="2021-08-22T05:58:06.000Z" title="Created 2021-08-22 13:58:06">2021-08-22</time></div></div><div class="aside-list-item no-cover"><div class="content"><a class="title" href="/2020/10/30/image-to-qq-painting/" title="ğŸ‘´ç©çˆ†QQæ¶‚é¸¦">ğŸ‘´ç©çˆ†QQæ¶‚é¸¦</a><time datetime="2020-10-30T09:57:33.000Z" title="Created 2020-10-30 17:57:33">2020-10-30</time></div></div><div class="aside-list-item no-cover"><div class="content"><a class="title" href="/2020/08/24/what-is-slow-in-text-warrior/" title="Text Warriorä¸­ä¸€äº›ä¸è¶³ä¹‹å¤„">Text Warriorä¸­ä¸€äº›ä¸è¶³ä¹‹å¤„</a><time datetime="2020-08-24T10:12:49.000Z" title="Created 2020-08-24 18:12:49">2020-08-24</time></div></div><div class="aside-list-item no-cover"><div class="content"><a class="title" href="/2020/04/25/android-dev-mistake/" title="è®°Androidå¼€å‘ä¸­ä¸€ä¸ªå‘ - ViewRootImpl">è®°Androidå¼€å‘ä¸­ä¸€ä¸ªå‘ - ViewRootImpl</a><time datetime="2020-04-25T02:54:55.000Z" title="Created 2020-04-25 10:54:55">2020-04-25</time></div></div></div></div></div></div></main><footer id="footer"><div id="footer-wrap"><div class="copyright">&copy;2020 - 2021 By Rosemoe</div><div class="framework-info"><span>Framework </span><a target="_blank" rel="noopener" href="https://hexo.io">Hexo</a><span class="footer-separator">|</span><span>Theme </span><a target="_blank" rel="noopener" href="https://github.com/jerryc127/hexo-theme-butterfly">Butterfly</a></div><div class="footer_custom_text">ã«ã‚ƒã‚“~</div></div></footer></div><div id="rightside"><div id="rightside-config-hide"><button id="readmode" type="button" title="Read Mode"><i class="fas fa-book-open"></i></button><button id="darkmode" type="button" title="Switch Between Light And Dark Mode"><i class="fas fa-adjust"></i></button><button id="hide-aside-btn" type="button" title="Toggle between single-column and double-column"><i class="fas fa-arrows-alt-h"></i></button></div><div id="rightside-config-show"><button id="rightside_config" type="button" title="Setting"><i class="fas fa-cog fa-spin"></i></button><button class="close" id="mobile-toc-button" type="button" title="Table Of Contents"><i class="fas fa-list-ul"></i></button><button id="go-up" type="button" title="Back To Top"><i class="fas fa-arrow-up"></i></button></div></div><div><script src="/js/utils.js"></script><script src="/js/main.js"></script><script src="https://cdn.jsdelivr.net/npm/vanilla-lazyload/dist/lazyload.iife.min.js"></script><script src="https://cdn.jsdelivr.net/npm/node-snackbar/dist/snackbar.min.js"></script><script>var preloader = {
  endLoading: () => {
    document.body.style.overflow = 'auto';
    document.getElementById('loading-box').classList.add("loaded")
  },
  initLoading: () => {
    document.body.style.overflow = '';
    document.getElementById('loading-box').classList.remove("loaded")

  }
}
window.addEventListener('load',preloader.endLoading())</script><div class="js-pjax"></div><script id="canvas_nest" defer="defer" color="255,0,0" opacity="0.7" zIndex="-1" count="99" mobile="false" src="https://cdn.jsdelivr.net/npm/butterfly-extsrc@1/dist/canvas-nest.min.js"></script><script id="click-show-text" src="https://cdn.jsdelivr.net/npm/butterfly-extsrc@1/dist/click-show-text.min.js" data-mobile="true" data-text="ã«ã‚ƒã‚“~" data-fontsize="15px" data-random="true" async="async"></script><script async data-pjax src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script></div></body></html>